---
name: Integrate Complete Workflow
status: open
created: 2025-10-04T15:52:52Z
updated: 2025-10-04T15:52:52Z
github: [Will be updated when synced to GitHub]
depends_on: [002, 003, 005, 006]
parallel: false
conflicts_with: []
---

# Task: Integrate Complete Workflow

## Description
Wire together all components to create the complete workflow: hotkey press → clipboard capture → API call → auto-paste. Handle errors gracefully at each stage and provide user feedback throughout the process.

## Acceptance Criteria
- [ ] Hotkey press triggers complete workflow end-to-end
- [ ] Clipboard text captured immediately on hotkey activation
- [ ] Prompt formatted and sent to Claude API
- [ ] API response pasted at cursor location
- [ ] Clear console logging at each workflow stage
- [ ] Error handling at each stage with user-friendly messages
- [ ] Graceful degradation if any stage fails

## Technical Details
**Workflow orchestration:**
```
1. User presses hotkey
2. Hotkey callback triggered
3. Read clipboard text
4. Validate clipboard has text
5. Format prompt with template
6. Send to Claude API (async)
7. Wait for complete response
8. Paste response at cursor
9. Log success or error
```

**Integration points:**
- Hotkey callback invokes workflow function
- Workflow function runs on tokio async runtime
- Error at any stage stops workflow and logs clear message
- User feedback via console logs

**Code structure:**
```rust
// src/workflow.rs
pub async fn execute_workflow(
    config: &Config,
    api_client: &ApiClient,
) -> Result<(), WorkflowError> {
    // Orchestrate all steps
}
```

**Error handling strategy:**
- Clipboard empty: "No text in clipboard"
- API error: "API call failed: {reason}"
- Paste error: "Response copied to clipboard (paste failed)"
- Each error logs to console with clear description

## Dependencies
- [ ] Task 002 (Global Hotkey System) - hotkey triggers workflow
- [ ] Task 003 (Clipboard Integration) - clipboard capture
- [ ] Task 005 (API Integration) - API client
- [ ] Task 006 (Auto-paste System) - response pasting

## Effort Estimate
- Size: M
- Hours: 4-6 hours
- Parallel: false (requires all core components complete)

## Definition of Done
- [ ] End-to-end workflow works on macOS
- [ ] User can copy text, press hotkey, and see AI response pasted
- [ ] Clear console output at each stage
- [ ] Errors handled gracefully with helpful messages
- [ ] Manual testing confirms reliable operation
- [ ] Workflow completes in <200ms after API response received
