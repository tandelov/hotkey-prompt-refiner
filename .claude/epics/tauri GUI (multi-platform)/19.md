---
name: Menu bar/system tray integration
status: open
created: 2025-10-05T19:47:36Z
updated: 2025-10-05T19:51:23Z
github: https://github.com/tandelov/hotkey-prompt-refiner/issues/19
depends_on: [20, 18]
parallel: true
conflicts_with: []
---

# Task: Menu bar/system tray integration

## Description

Implement native menu bar integration for macOS and system tray support for Linux/Windows. Provide visual status indicators and quick access menu items for common actions (Settings, History, Enable/Disable, Quit). The menu bar icon should reflect the application's current state (active, inactive, processing).

## Acceptance Criteria

- [ ] macOS menu bar displays application icon with status indicator
- [ ] Linux/Windows system tray shows application icon
- [ ] Menu items implemented: Settings, History, Enable/Disable, Quit
- [ ] Visual status changes: active (normal), inactive (dimmed), processing (animated/badge)
- [ ] Clicking menu items triggers appropriate actions (open settings window, show history, toggle hotkey, quit app)

## Technical Details

**Implementation Approach:**
- Use `tauri-plugin-positioner` for menu bar positioning
- macOS: `NSStatusBar` integration via Tauri
- Linux/Windows: System tray API via Tauri's built-in tray support
- Status indicator states managed via Tauri state management
- Icon variants: `icon-active.png`, `icon-inactive.png`, `icon-processing.png`

**Files Affected:**
- `src-tauri/src/main.rs` - Tray/menu bar initialization
- `src-tauri/src/tray.rs` (new) - Menu bar/tray logic
- `src-tauri/icons/` - Status indicator icon variants
- `src-tauri/tauri.conf.json` - Tray configuration
- `src/components/MenuBar.tsx` (if web-based menu needed)

**Key APIs:**
- `tauri::SystemTray` and `tauri::SystemTrayMenu`
- Platform-specific icon updates via `app_handle.tray_handle().set_icon()`

## Dependencies

- [x] Task 20: Basic Tauri UI shell (window management)
- [x] Task 18: History tracking system (for History menu item)
- [ ] Platform-specific icon assets created
- [ ] Tauri system tray APIs configured

## Effort Estimate

**Size:** M
**Hours:** 8-12
**Parallel:** true (can run alongside Task 13)

## Definition of Done

- [ ] Code implemented and committed
- [ ] Unit tests for menu action handlers
- [ ] Manual testing on macOS, Linux, and Windows
- [ ] Status indicator transitions verified
- [ ] Documentation updated (user guide for menu bar usage)
- [ ] Code review completed
- [ ] No memory leaks from icon updates
- [ ] Performance verified (< 1% CPU for status updates)
