import"../chunks/Bzak7iHL.js";import{a5 as mt,a6 as g,a7 as xt,u as ht,D as t,a8 as _,ad as l,a9 as V,a4 as p,aa as yt,ab as f,ac as r,ae as e,a2 as bt,a3 as gt}from"../chunks/BitGGxQW.js";import{d as wt,s as d}from"../chunks/CKAymY6x.js";import{i as $}from"../chunks/Cb4_0wpw.js";import{e as kt}from"../chunks/BUgxogYU.js";import{b as Tt,i as j,r as Ft,s as Ct}from"../chunks/DK4AQOE3.js";async function Ht(m,n){if(confirm("Are you sure you want to clear all history? This cannot be undone."))try{await j("clear_history"),f(n,[],!0)}catch(s){console.error("Failed to clear history:",s),alert(`Failed to clear history: ${s}`)}}var Mt=_('<div class="loading svelte-1xl2tfr">Loading history...</div>'),Dt=_('<div class="empty-state svelte-1xl2tfr"><p>No history entries yet.</p> <p class="hint svelte-1xl2tfr">History will appear here after you process text using hotkeys.</p></div>'),It=(m,n,s)=>n(t(s).timestamp),At=(m,n,s)=>n(t(s).full_source),Et=(m,n,s)=>n(t(s).full_result),Ot=_('<div class="expanded-content svelte-1xl2tfr"><div class="full-content svelte-1xl2tfr"><div class="content-header svelte-1xl2tfr"><strong class="svelte-1xl2tfr">Full Input</strong> <button class="copy-btn svelte-1xl2tfr">Copy</button></div> <pre class="content-text svelte-1xl2tfr"> </pre></div> <div class="full-content svelte-1xl2tfr"><div class="content-header svelte-1xl2tfr"><strong class="svelte-1xl2tfr">Full Output</strong> <button class="copy-btn svelte-1xl2tfr">Copy</button></div> <pre class="content-text svelte-1xl2tfr"> </pre></div></div>'),St=_('<div class="history-item svelte-1xl2tfr"><div class="history-header svelte-1xl2tfr"><div class="history-info svelte-1xl2tfr"><span class="template-name svelte-1xl2tfr"> </span> <span class="timestamp svelte-1xl2tfr"> </span></div> <button class="expand-btn svelte-1xl2tfr"> </button></div> <div class="preview-section svelte-1xl2tfr"><div class="preview-item svelte-1xl2tfr"><span class="preview-label svelte-1xl2tfr">Input:</span> <span class="preview-text svelte-1xl2tfr"> </span></div> <div class="preview-item svelte-1xl2tfr"><span class="preview-label svelte-1xl2tfr">Output:</span> <span class="preview-text svelte-1xl2tfr"> </span></div></div> <!></div>'),Bt=_('<div class="history-list svelte-1xl2tfr"></div>'),Lt=_('<main class="container svelte-1xl2tfr"><div class="header svelte-1xl2tfr"><h1 class="svelte-1xl2tfr">History</h1> <a href="/" class="back-link svelte-1xl2tfr">← Back to Home</a></div> <p class="subtitle svelte-1xl2tfr">View your recent prompt processing history (last 100 entries).</p> <div class="controls svelte-1xl2tfr"><input type="text" placeholder="Search by template name or content..." class="search-input svelte-1xl2tfr"/> <button class="btn btn-danger svelte-1xl2tfr">Clear All</button></div> <!></main>');function zt(m,n){mt(n,!0);let s=g(xt([])),w=g(""),x=g(null),k=g(!0);async function q(){f(k,!0);try{f(s,await j("get_history"),!0)}catch(a){console.error("Failed to load history:",a)}finally{f(k,!1)}}async function Z(a){if(!a.trim()){await q();return}try{f(s,await j("search_history",{query:a.trim()}),!0)}catch(i){console.error("Failed to search history:",i)}}async function z(a){try{await navigator.clipboard.writeText(a),alert("Copied to clipboard!")}catch(i){console.error("Failed to copy:",i),alert("Failed to copy to clipboard")}}function tt(a){f(x,t(x)===a?null:a,!0)}function et(a){const i=new Date(a),M=new Date().getTime()-i.getTime(),y=Math.floor(M/1e3),v=Math.floor(y/60),c=Math.floor(v/60),u=Math.floor(c/24);return u>0?`${u}d ago`:c>0?`${c}h ago`:v>0?`${v}m ago`:`${y}s ago`}let T;ht(()=>{T&&clearTimeout(T),T=setTimeout(()=>{Z(t(w))},300)}),q();var F=Lt(),C=l(r(F),4),H=r(C);Ft(H);var G=l(H,2);G.__click=[Ht,s],e(C);var at=l(C,2);{var rt=a=>{var i=Mt();p(a,i)},st=a=>{var i=bt(),J=gt(i);{var M=v=>{var c=Dt();p(v,c)},y=v=>{var c=Bt();kt(c,21,()=>t(s),u=>u.timestamp,(u,o)=>{var D=St(),I=r(D),A=r(I),E=r(A),lt=r(E,!0);e(E);var K=l(E,2),ot=r(K,!0);e(K),e(A);var b=l(A,2);b.__click=[It,tt,o];var it=r(b,!0);e(b),e(I);var O=l(I,2),S=r(O),P=l(r(S),2),vt=r(P,!0);e(P),e(S);var R=l(S,2),U=l(r(R),2),nt=r(U,!0);e(U),e(R),e(O);var ct=l(O,2);{var pt=h=>{var B=Ot(),L=r(B),N=r(L),dt=l(r(N),2);dt.__click=[At,z,o],e(N);var W=l(N,2),ft=r(W,!0);e(W),e(L);var X=l(L,2),Q=r(X),ut=l(r(Q),2);ut.__click=[Et,z,o],e(Q);var Y=l(Q,2),_t=r(Y,!0);e(Y),e(X),e(B),V(()=>{d(ft,t(o).full_source),d(_t,t(o).full_result)}),p(h,B)};$(ct,h=>{t(x)===t(o).timestamp&&h(pt)})}e(D),V(h=>{d(lt,t(o).template_name),d(ot,h),Ct(b,"aria-label",t(x)===t(o).timestamp?"Collapse":"Expand"),d(it,t(x)===t(o).timestamp?"−":"+"),d(vt,t(o).source_preview),d(nt,t(o).result_preview)},[()=>et(t(o).timestamp)]),p(u,D)}),e(c),p(v,c)};$(J,v=>{t(s).length===0?v(M):v(y,!1)},!0)}p(a,i)};$(at,a=>{t(k)?a(rt):a(st,!1)})}e(F),V(()=>G.disabled=t(s).length===0),Tt(H,()=>t(w),a=>f(w,a)),p(m,F),yt()}wt(["click"]);export{zt as component};
